<div x-data="projectsData">
  <template x-if="loading">
    <creastina-loader></creastina-loader>
  </template>
  <template x-if="!loading">
    <div class="creastina-view">
      <aside class="creastina-sidebar">
        <div class="creastina-sidebar__header">
          <svg viewBox="0 0 24 24">
            <g fill="none" stroke="currentColor" stroke-width="2">
              <path stroke-linecap="round" stroke-linejoin="round" d="M3 7h3M3 17h6m9 0h3M15 7h6"/>
              <path
                d="M6 7c0-.932 0-1.398.152-1.765a2 2 0 0 1 1.083-1.083C7.602 4 8.068 4 9 4s1.398 0 1.765.152a2 2 0 0 1 1.083 1.083C12 5.602 12 6.068 12 7s0 1.398-.152 1.765a2 2 0 0 1-1.083 1.083C10.398 10 9.932 10 9 10s-1.398 0-1.765-.152a2 2 0 0 1-1.083-1.083C6 8.398 6 7.932 6 7Zm6 10c0-.932 0-1.398.152-1.765a2 2 0 0 1 1.083-1.083C13.602 14 14.068 14 15 14s1.398 0 1.765.152a2 2 0 0 1 1.083 1.083C18 15.602 18 16.068 18 17s0 1.398-.152 1.765a2 2 0 0 1-1.083 1.083C16.398 20 15.932 20 15 20s-1.398 0-1.765-.152a2 2 0 0 1-1.083-1.083C12 18.398 12 17.932 12 17Z"/>
            </g>
          </svg>
          <span>Meine Kategorien</span>
        </div>
        <div class="creastina-sidebar__content">
          <template x-for="category in categories" :key="category.id">
            <a
              @click="selectCategory(category)"
              x-active="selectedCategory?.id === category.id"
              class="creastina-sidebar__item"
              x-text="category.name"
            ></a>
          </template>
        </div>
        <button @click="createCategory" class="creastina-sidebar__button">
          <svg viewBox="0 0 24 24">
            <path
              fill="none"
              stroke="currentColor"
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="1.5"
              d="M12 4v16m8-8H4"
            />
          </svg>
          Neue Kategorie
        </button>
      </aside>
      <template x-if="selectedCategory">
        <div class="creastina-content">
          <div class="creastina-toolbar">
            <button class="creastina-button is--primary" @click="createProject">Neues Projekt</button>
            <button class="creastina-button" :class="{ 'is--toggled': archived }" @click="toggleArchived">Archivierte
              Projekte
            </button>
            <button class="creastina-button" @click="archiveAll">Alle Projekte archivieren</button>
          </div>
          <div class="creastina-card__list">
            <template x-for="project in filteredProjects" :key="project.id">
              <div class="creastina-card">
                <div class="creastina-card__header">
                  <span x-text="project.name"></span>
                  <div class="creastina-card__buttons">
                    <template x-if="!project.isArchived">
                      <button class="creastina-button is--icon is--primary" @click="archiveProject(project)">
                        <svg viewBox="0 0 24 24">
                          <g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"
                             stroke-width="2">
                            <path
                              d="M7 21h10c2.357 0 3.535 0 4.268-.732C22 19.535 22 18.357 22 16s0-3.536-.732-4.268C20.535 11 19.357 11 17 11H7c-2.357 0-3.535 0-4.268.732S2 13.642 2 16s0 3.535.732 4.268S4.642 21 7 21M4 11c0-1.4 0-2.1.273-2.635a2.5 2.5 0 0 1 1.092-1.092C5.9 7 6.6 7 8 7h8c1.4 0 2.1 0 2.635.272a2.5 2.5 0 0 1 1.092 1.093C20 8.9 20 9.6 20 11M6 7c0-1.4 0-2.1.273-2.635a2.5 2.5 0 0 1 1.092-1.092C7.9 3 8.6 3 10 3h4c1.4 0 2.1 0 2.635.272a2.5 2.5 0 0 1 1.092 1.093C18 4.9 18 5.6 18 7"/>
                            <path
                              d="m16 15l-.3.4c-.589.785-.883 1.178-1.306 1.389c-.422.211-.913.211-1.894.211h-1c-.981 0-1.472 0-1.894-.211c-.423-.211-.717-.604-1.306-1.389L8 15"/>
                          </g>
                        </svg>
                      </button>
                    </template>
                    <template x-if="project.isArchived">
                      <button class="creastina-button is--icon is--primary" @click="unarchiveProject(project)">
                        <svg viewBox="0 0 24 24">
                          <g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"
                             stroke-width="2">
                            <path
                              d="M21 7H3v6c0 3.771 0 5.657 1.172 6.828S7.229 21 11 21h2c3.771 0 5.657 0 6.828-1.172S21 16.771 21 13zm0 0H3l1.2-1.6c.883-1.178 1.325-1.767 1.958-2.083C6.792 3 7.528 3 9 3h6c1.472 0 2.208 0 2.842.317c.633.316 1.075.905 1.958 2.083z"/>
                            <path d="M12 11v6.5m-3-4c.59-.607 2.16-3 3-3s2.41 2.393 3 3"/>
                          </g>
                        </svg>
                      </button>
                    </template>
                    <button class="creastina-button is--icon is--primary" @click="updateProject(project)">
                      <svg viewBox="0 0 24 24">
                        <path
                          fill="none"
                          stroke="currentColor"
                          stroke-linecap="round"
                          stroke-linejoin="round"
                          stroke-width="2"
                          d="M3.5 18.985V20.5h1.514c1.227 0 1.84 0 2.391-.228c.551-.229.985-.662 1.852-1.53l9.864-9.863c.883-.883 1.324-1.324 1.373-1.866q.012-.135 0-.269c-.05-.541-.49-.983-1.373-1.865c-.883-.883-1.324-1.324-1.865-1.373a1.5 1.5 0 0 0-.27 0c-.541.049-.982.49-1.865 1.373l-9.864 9.864c-.867.867-1.3 1.3-1.529 1.852c-.228.55-.228 1.164-.228 2.39M13.5 6.5l4 4"
                        />
                      </svg>
                    </button>
                    <button class="creastina-button is--icon is--negative" @click="deleteProject(project)">
                      <svg viewBox="0 0 24 24">
                        <path
                          fill="none"
                          stroke="currentColor"
                          stroke-linecap="round"
                          stroke-width="2"
                          d="m19.5 5.5l-.62 10.025c-.158 2.561-.237 3.842-.88 4.763a4 4 0 0 1-1.2 1.128c-.957.584-2.24.584-4.806.584c-2.57 0-3.855 0-4.814-.585a4 4 0 0 1-1.2-1.13c-.642-.922-.72-2.205-.874-4.77L4.5 5.5M9 11.735h6m-4.5 3.919h3M3 5.5h18m-4.945 0l-.682-1.408c-.454-.936-.68-1.403-1.071-1.695a2 2 0 0 0-.275-.172C13.594 2 13.074 2 12.034 2c-1.065 0-1.598 0-2.039.234a2 2 0 0 0-.278.18c-.396.303-.617.788-1.059 1.757L8.053 5.5"
                        />
                      </svg>
                    </button>
                  </div>
                </div>
                <div class="creastina-card__content">
                  <span x-text="project.note" class="creastina-card__not-so-sidenote"></span>
                  <ul class="creastina-project__inventory">
                    <template x-for="item in project.inventoryItems" :key="item.id">
                      <li class="creastina-project__inventory-item is--card">
                        <div class="creastina-project__inventory-name">
                          <span x-text="item.count + 'Ã—'"></span>
                          <span x-text="item.name"></span>
                        </div>
                        <span class="creastina-project__inventory-note" style="font: var(--not-so-sidenote)" x-text="item.note"></span>
                      </li>
                    </template>
                  </ul>
                </div>
              </div>
            </template>
            <template x-if="projects.length === 0">
              <div class="creastina-message">
                <p>Die Kategorie <span x-text="selectedCategory.name"></span> ist leer, leg doch ein Projekt an</p>
              </div>
            </template>
            <template x-if="projects.length !== 0 && filteredProjects.length === 0">
              <div class="creastina-message">
                <p>
                  Zu deiner Suche wurde nichts in der Katgorie <span x-text="selectedCategory.name"></span> gefunden
                </p>
              </div>
            </template>
          </div>
        </div>
      </template>
    </div>
  </template>
</div>
